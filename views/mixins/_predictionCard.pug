include _rating

mixin predictionCard(prediction = {})
  .column
    .ui.fluid.card
      .content
        .right.floated.meta
          +rating(prediction.author)
        if prediction.author.avatar
          img.ui.avatar.image(src=`/uploads/${prediction.author.avatar}`)
          a(href=`/user/profile/${prediction.author.username}`) #{prediction.author.username}
        else
          img.ui.avatar.image(src=prediction.author.gravatar + '&d=wavatar')
          a(href=`/user/profile/${prediction.author.username}`) #{prediction.author.username}
      .content
        form.ui.form.card-form(method="POST" action=`/api/add-to-cart/${prediction._id}`)
          if session.cart
            - const bought = session.cart.content.includes(prediction.id) ? 'ui inverted pink' : ''
            table.ui.celled.table.unstackable(class=bought name='preditable')
              thead
                tr
                  th Date
                  th Time
                  th Home
                  th Away
              tbody
              for team in prediction.team.slice(0,3)
                tr
                  td #{team.date.toISOString().slice(0,10).replace(/-/g,"/")}
                  td #{new Date(team.date).toLocaleTimeString([], {timeZone: 'Africa/Nairobi',hour: '2-digit', minute:'2-digit'})}
                  td #{team.home}
                  td #{team.away}
              for team in prediction.team.slice(3)
                tr.more.show-more
                  td #{team.date.toISOString().slice(0,10).replace(/-/g,"/")}
                  td #{new Date(team.date).toLocaleTimeString([], {timeZone: 'Africa/Nairobi',hour: '2-digit', minute:'2-digit'})}
                  td #{team.home}
                  td #{team.away}
          else
            table.ui.celled.table.unstackable(name='preditable')
              thead
                tr
                  th Date
                  th Time
                  th Home
                  th Away
              tbody
              for team in prediction.team.slice(0,3)
                tr
                  td #{team.date.toISOString().slice(0,10).replace(/-/g,"/")}
                  td #{new Date(team.date).toLocaleTimeString([], {timeZone: 'Africa/Nairobi',hour: '2-digit', minute:'2-digit'})}
                  td #{team.home}
                  td #{team.away}
              for team in prediction.team.slice(3)
                tr.more.show-more
                  td #{team.date.toISOString().slice(0,10).replace(/-/g,"/")}
                  td #{new Date(team.date).toLocaleTimeString([], {timeZone: 'Africa/Nairobi',hour: '2-digit', minute:'2-digit'})}
                  td #{team.home}
                  td #{team.away}
          if session.cart
            - const boughtClass = session.cart.content.includes(prediction.id) ? 'disabled' : ''
              .content.games_control
                span.game_length #{prediction.team.length} games
                button.ui.basic.purple.button.more-predictions(name='more')
                  span.view-more #{`VIEW `}
                  span.more-less MORE
                if user && orders.includes(prediction._id.toString())
                  button.ui.button.purple(class='disabled') BOUGHT
                else
                  button.ui.basic.purple.button.right.floated(type='submit' name='buy' data-index=`${i}` class=boughtClass) BUY

          else
            .content.games_control
              span.game_length #{prediction.team.length} games
              button.ui.basic.purple.button.more-predictions
                span.view-more #{`VIEW `}
                span.more-less MORE
              if user && orders.includes(prediction._id.toString())
                button.ui.button.purple(class='disabled') BOUGHT
              else
                button.ui.basic.purple.button.right.floated(type='submit' name='buy' data-index=`${i}`) BUY
